#!/bin/bash
echo 142 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio142/direction
# Function to send data via RS485
send_data() {
    echo "Sending data..."
    echo 0 > /sys/class/gpio/gpio142/value
    uart_test -m 1 -b 115200 -l -d /dev/ttyLP2 -w 1234567890
}

# Function to receive data via RS485
receive_data() {
    echo "Receiving data..."
    echo 1 > /sys/class/gpio/gpio142/value
    uart_test -m 1 -b 115200 -l -d /dev/ttyLP2
}

# Main menu
while true; do
    echo "Select RS485 operation:"
    echo "1. Send data"
    echo "2. Receive data"
    echo "3. Exit"

    read -p "Enter your choice: " choice

    case $choice in
        1)
            send_data
            ;;
        2)
            receive_data
            ;;
        3)
            echo "Exiting..."
            exit 0
            ;;
        *)
            echo "Invalid choice. Please enter 1, 2, or 3."
            ;;
    esac
done
